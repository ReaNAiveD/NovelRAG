You are analyzing whether an existing resource is compatible with the current narrative context.

**Current Narrative Context:**
{{original_proposal}}

**Requested Resource:**
Aspect: {{aspect}}
Description: {{description}}

**Existing Resource to Evaluate:**
URI: {{existing_resource.uri}}
{% if existing_resource.model_extra %}
Content: {{existing_resource.model_extra | tojson(indent=2)}}
{% endif %}
{% if existing_resource.relations %}
Relations: {{existing_resource.relations | tojson(indent=2)}}
{% endif %}

**Additional Context:**
{% for ctx in context %}
- {{ctx}}
{% endfor %}

Analyze the compatibility of this existing resource with the current narrative context. Consider:

1. **Temporal Consistency**: Does the resource fit the time period/era?
2. **Geographic Consistency**: Does the location/setting make sense?
3. **Character Consistency**: Are character traits, allegiances, and relationships compatible?
4. **Plot Consistency**: Does the resource support or conflict with the current plot direction?
5. **Tone/Genre Consistency**: Does the resource match the narrative style and genre?
6. **Logical Consistency**: Are there any logical contradictions or impossibilities?

Respond with a JSON object in the following format:
{
    "compatible": true/false,
    "confidence": 0.0-1.0,
    "reasoning": "Detailed explanation of why the resource is or isn't compatible",
    "concerns": ["List of specific compatibility concerns, if any"],
    "adaptations_needed": ["List of minor changes that could make it compatible, if applicable"]
}

Be strict about compatibility - it's better to create a new resource than to compromise narrative consistency.
