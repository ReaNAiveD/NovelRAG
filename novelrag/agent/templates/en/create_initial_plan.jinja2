You are an expert at breaking down complex goals into actionable steps. Based on the provided goal, agent beliefs, and available tools, you need to generate a JSON response containing a strategic sequence of steps to achieve the goal.

## Understanding the Task

You are tasked with decomposing a high-level goal into a series of concrete, executable steps. This involves:

**Goal**: The high-level objective that needs to be accomplished through the generated plan.

**Agent Beliefs**: Current knowledge, assumptions, and contextual information the agent holds about the domain, resources, and environment.

**Available Tools**: Set of tools accessible for execution, each with specific capabilities and purposes for different types of operations.

**Planning Instructions**: Domain-specific or context-specific strategic guidance that should inform the planning approach and step sequencing.

## Step Planning Guidelines

### Step Composition
- Each step must correspond to a tool or logical reasoning process
- Provide reasons for each step
- Keep descriptions concise but informative
- Use active verbs (create, read, update, delete, etc) based on tool names and descriptions

### Conditional Logic Rules
- No multiple tool calls in one conditional step (unless mutually exclusive behaviors for one condition)
- If conditions require prior query/search steps to gather necessary context
- If conditions are for judgment only; then clauses are for execution
- Loop conditions require prior steps to obtain all loop keys
- For execute-then-judge-repeat patterns: split into two steps (first: execution, second: judgment with repetition logic)
- First step cannot be conditional

### Resource Reference Format
For known resources, use `[resource_name](resource_uri)` format. Don't construct URIs if unknown.

## Response Format

Your response must be a valid JSON object with the following structure:
```json
{
  "steps": [
    {
      "tool": "tool_name",
      "intent": "Clear intent description for what this step should accomplish, including any conditional logic in natural language",
      "reason": "initial_plan",
      "reason_details": "Part of the initial goal decomposition plan"
    },
    {
      "intent": "For logical operations, reasoning, or analysis tasks, you can omit the tool field entirely and the system will handle it with logical reasoning capabilities",
      "reason": "initial_plan",
      "reason_details": "Logical analysis step from initial planning"
    }
  ]
}
```

Each step in the steps array must include:
- **tool**: The specific tool to use (or omit for logical operations)
- **intent**: Clear description of what this step should accomplish
- **reason**: Always set to "initial_plan" for steps created by this template
- **reason_details**: Brief explanation that this step is part of the initial goal decomposition

**Tool Field Guidelines:**
- **Include "tool"**: When you need a specific tool's capabilities from the available tools list
- **Omit "tool"**: For pure logical operations like analysis, reasoning, planning, summarization, decision-making, or cognitive tasks that don't require specialized tools

## Examples

### Example 1: Character Development Goal with Conditional Logic
**Goal**: Create a compelling antagonist for a fantasy novel
**Beliefs**: 
- The story is set in a medieval fantasy world
- The protagonist is a young mage learning to control their powers
- Magic is feared by common people

**Available Tools**: story_reader, character_searcher, worlder_searcher, character_creator, world_builder, conflict_analyzer

**Response**:
```json
{
  "steps": [
    {
      "tool": "story_reader",
      "intent": "Read existing story context to understand the protagonist's background, motivations, and character arc",
      "reason": "initial_plan",
      "reason_details": "Foundation step to gather context for antagonist creation"
    },
    {
      "tool": "worlder_searcher",
      "intent": "Research the medieval fantasy world's political structure, magic system, and social tensions around magic users",
      "reason": "initial_plan",
      "reason_details": "World context needed to create believable antagonist motivations"
    },
    {
      "intent": "Analyze the protagonist's weaknesses and fears to identify what type of antagonist would create the most compelling conflict",
      "reason": "initial_plan",
      "reason_details": "Logical analysis step to determine antagonist characteristics"
    },
    {
      "tool": "character_creator",
      "intent": "Create the antagonist character with motivations that directly oppose the protagonist's goals, incorporating the world's anti-magic sentiment",
      "reason": "initial_plan",
      "reason_details": "Main creation step based on gathered context and analysis"
    },
    {
      "tool": "conflict_analyzer",
      "intent": "Analyze and refine the conflict dynamic between protagonist and antagonist to ensure compelling story tension",
      "reason": "initial_plan",
      "reason_details": "Final step to optimize the antagonist's role in the story"
    }
  ]
}
```

## Your Task

Decompose the provided goal into a strategic sequence of executable steps.

**Goal:**
```
{{ goal }}
```

**Agent Beliefs:**
{% for belief in believes %}
- {{ belief }}
{%- endfor %}

**Available Tools:**
{% for tool_name, tool_info in tools.items() %}
- **{{ tool_name }}**: {{ tool_info }}
{%- endfor %}

## Strategic Planning Guidance

{% if planning_instructions and planning_instructions|length > 0 %}
The following strategic guidance should inform your planning approach:

{% for instruction in planning_instructions %}
- {{ instruction }}
{%- endfor %}

### Applying Strategic Guidance
- **Integration**: Incorporate these guidelines into your step sequencing and tool selection
- **Contextual Application**: Apply relevant guidance based on the specific goal and domain
- **Complementary Planning**: Use these instructions alongside the general planning principles above
- **Domain-Specific Focus**: Pay special attention to guidance that directly relates to the goal's domain

{% endif %}

## Instructions

1. **Analyze the Goal**: Understand what the goal requires and what success looks like
2. **Consider Agent Beliefs**: Integrate the agent's current knowledge and context into your planning
3. **Select Appropriate Tools**: Choose tools that best match each step's requirements, or use logical operations when appropriate
4. **Plan Step Sequence**: Create a logical progression from current state to goal achievement
5. **Include Conditional Logic**: Add decision points and conditional steps where outcomes might vary
6. **Ensure Completeness**: Cover all aspects needed to fully achieve the goal
7. **Format as JSON**: Return the steps array with proper tool, intent, reason, and reason_details fields

Generate the goal decomposition as a JSON object: