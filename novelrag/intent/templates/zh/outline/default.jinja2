{% import "zh/cne/_macros.jinja2" as macros %}

{{ macros.language_instruction() }}

{% if user_input %}
---Default 故事大纲处理流程---
系统必须根据输入意图灵活处理：如果用户仅进行查询（即“读”），则输出详细响应内容，包括上下文说明与决策原因，但不生成 JSON 操作指令；如属编辑类操作，则需在输出中同时包含解释性文本与合法 JSON 操作区块。
> 自动判断新增/更新需求，兼容用户输入
> 输出格式严格遵循Operation Command JSON Schema
{% endif %}

---事件定义（Definition）---
故事大纲是由一系列有序事件构成的结构化列表，用于描述故事发展的顺序与具体细节。每个事件都具备相对独立的叙事阶段，包括开端、发展、高潮、回落和结局。当事件粒度较大时，该事件可以进一步细分为多个子事件。子事件并不严格对应父事件的五个阶段，而是对其中某一阶段的具体细化与展开，从而形成一种嵌套结构：这种结构使得故事在宏观层面保持节奏清晰，在微观层面则能展现丰富的细节与情感张力。一个子事件可能涉及一个或多个元素，甚至仅对应某个元素的一部分。
每一个事件都会明确描述其中涉及的角色，并通常对主线推进、角色成长或情绪变化具有推动作用。事件可以承载特定的情绪基调，如紧张、悲伤、希望或愤怒，并通过情节设计激发读者的情感共鸣。事件的发生可能会改变角色的认知、选择或命运，同时揭示其性格特征或内在矛盾。
事件之间存在因果联系：当前事件可能是由前一事件所引发，也可能回应了此前设置的伏笔；同时，它还可能为后续事件埋下新的伏笔。不同事件的时间跨度各不相同，但父事件的时间范围应当涵盖其所有子事件的发生时间。
此外，事件的发展通常包含冲突——即角色在追求目标过程中所遭遇的阻碍或对立力量。冲突一般由三个核心要素构成：目标、障碍与努力。冲突可分为内部冲突（如心理挣扎、道德抉择）和外部冲突（如人与人之间的对抗、自然环境的挑战、社会制度的压迫或命运的干预）。随着事件的推进，冲突的强度可能会逐步升级，并在后续事件中演化为更复杂或更具张力的形式。

* `name`(string, required): 事件的核心标题，需精准概括事件本质及关键转折点，体现叙事焦点
* `characters`(array<string>, required): 参与事件的完整角色名单，标注角色在事件中的功能性定位（如冲突发起者/解决者/被动影响者）
* `introduction`(string, optional): 事件开端阶段的场景构建与背景铺陈，包含时空坐标、初始矛盾触发点及角色动机暗示
* `rising`(string, optional): 冲突升级的动态过程，包含角色采取的主动行动、遭遇的阻力及阶段性转折的累积效应
* `climax`(string, optional): 事件张力峰值的具象化呈现，包含关键抉择时刻、颠覆性真相揭露或不可逆后果的爆发性显现
* `fallout`(string, optional): 高潮后效应的扩散路径，包含直接后果的连锁反应、次要矛盾的显性化及新冲突的萌芽形态
* `resolution`(string, optional): 事件最终状态说明，包含目标完成度、角色状态变更及遗留问题清单
* `emotionalTone`(array<string>, optional): 情感氛围清单，列示主要情绪类型（如悲伤）与次要情绪类型（如希望）
* `narrativeFunction`(array<string>, optional): 叙事价值说明清单：1) 主线推进作用 2) 角色发展节点 3) 世界观规则展示 4) 叙事节奏调节功能 5) 其他叙事的推动作用
* `conflict`(array<string>, optional): 冲突要素清单，每个冲突会包含：1) 目标与阻碍关系 2) 角色的努力与对抗力量对比 3) 冲突的其他描述
* `causal`(array<string>, optional): 因果关联标识清单，记录本事件引发的后续事件编号及解答的前期悬念编号
* `foreshadowing`(array<string>, optional): 事件埋下的伏笔，可能包含有：象征性物品，预言性对话，双关隐喻，身体异常反应，梦境预言画面，书籍内容关联等
